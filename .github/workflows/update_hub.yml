name: Sync Wiki to Hub
on:
  push:
    branches: [ main ] 

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Wiki
        uses: actions/checkout@v3
        with:
          path: wiki

      - name: Checkout Hub
        uses: actions/checkout@v3
        with:
          repository: qtetech/qtetech.github.io
          token: ${{ secrets.GH_PAT }}
          path: hub

      - name: Update Hub README
        run: |
          cd wiki
          # Táº¡o danh sÃ¡ch bÃ i viáº¿t theo Ä‘á»‹nh dáº¡ng Markdown Ä‘Æ¡n giáº£n
          LIST=$(find . -maxdepth 1 -name "*.md" ! -name "README.md" | sed 's|./||' | sort -r | head -n 10 | while read line; do
            echo "- [$line](https://github.com/qtetech/qte-technologies-every-industrial-and-scientific-wiki/blob/main/$line)"
          done)
          
          cd ../hub
          # XÃ³a pháº§n cÅ© tá»« má»¥c Latest trá»Ÿ Ä‘i (náº¿u cÃ³)
          sed -i '/## ðŸ†• Latest Technical Updates:/,$d' README.md
          
          # Ghi má»¥c má»›i vÃ o cuá»‘i file
          echo -e "\n## ðŸ†• Latest Technical Updates:\n" >> README.md
          echo "$LIST" >> README.md
          
          # Cáº¥u hÃ¬nh Git vÃ  Ä‘áº©y lÃªn
          git config --global user.name "QTE-Bot"
          git config --global user.email "bot@qtetech.com"
          git add README.md
          git commit -m "Neural Update: Sync latest wiki articles" || echo "No changes to commit"
          git push origin main
