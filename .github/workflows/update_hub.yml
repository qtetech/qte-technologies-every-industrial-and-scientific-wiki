name: Sync Wiki to Hub
on:
  push:
    branches: [ main ] 

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Wiki
        uses: actions/checkout@v3
        with:
          path: wiki

      - name: Checkout Hub
        uses: actions/checkout@v3
        with:
          repository: qtetech/qtetech.github.io
          token: ${{ secrets.GH_PAT }}
          path: hub

      - name: Update Hub README
        run: |
          cd wiki
          # Láº¥y danh sÃ¡ch bÃ i viáº¿t .md, loáº¡i bá» README vÃ  cÃ¡c file áº©n
          # Äá»‹nh dáº¡ng láº¡i thÃ nh link markdown
          LIST=$(find . -maxdepth 1 -name "*.md" ! -name "README.md" | sed 's|./|- [|g' | sed 's|.md|](https://github.com/qtetech/qte-technologies-every-industrial-and-scientific-wiki/blob/main/&)|g')
          
          cd ../hub
          # XÃ³a pháº§n cÅ© tá»« dÃ²ng "### ðŸ†• Latest Technical Updates" náº¿u Ä‘Ã£ cÃ³
          sed -i '/### ðŸ†• Latest Technical Updates/,$d' README.md
          
          # ThÃªm danh sÃ¡ch má»›i vÃ o cuá»‘i file README
          echo -e "\n### ðŸ†• Latest Technical Updates:\n$LIST" >> README.md
          
          git config --global user.name "QTE-Bot"
          git config --global user.email "bot@qtetech.com"
          git add README.md
          git commit -m "Neural Update: Sync latest wiki articles" || echo "No changes to commit"
          git push
